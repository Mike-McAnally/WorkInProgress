<!DOCTYPE>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width,shrink-to-fit=no,user-scalable=no,maximum-scale=1,minimum-scale=1">
    <title>Mind Palace VR Node B</title>
    <meta name="description" content="This is a single node in the Mind Palace structure."></meta>
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0, shrink-to-fit=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="gray-translucent" />
<!-- A-frame component libraries -->
    <script src="https://rocketvirtual.com/aframe-master_9.2_old3/dist/aframe-master.min.js"></script>
    <script src="https://rocketvirtual.com/aframe-environment-component-master/dist/aframe-environment-component.js"></script>
    <script src="https://rocketvirtual.com/aframe-extras-master/dist/aframe-extras.min.js"></script>
    <script src="https://rocketvirtual.com/aframe-teleport-controls-master/dist/aframe-teleport-controls.min.js"></script>
    <script src="https://rocketvirtual.com/superframe-master/components/text-geometry/dist/aframe-text-geometry-component.min.js"></script>
<!-- extra stuff for later on... you can look them up on github  -->
    <script src="https://rocketvirtual.com/aframe-alongpath-component-master/dist/aframe-alongpath-component.min.js" ></script>
    <script src="https://rocketvirtual.com/aframe-curve-component-master/dist/aframe-curve-component.min.js"></script>
    <script src="https://rocketvirtual.com/aframe-mouse-cursor-component-master/dist/aframe-mouse-cursor-component.min.js"></script>
    <script src="https://rocketvirtual.com/aframe-multisrc-component-master/dist/aframe-multisrc-component.js"></script>
    <script src="https://rocketvirtual.com/aframe-particle-system-component-master/dist/aframe-particle-system-component.min.js"></script>

<!-- see a-frame scene below https://github.com/donmccurdy/aframe-inspector-plugin-recast
    <script src="https://recast-api.donmccurdy.com/aframe-inspector-plugin-recast.js"></script>
-->

        <script type="text/javascript">


      // Component to do on click.
      AFRAME.registerComponent('click-listener', {
        init: function () {

            this.el.addEventListener('click', function (evt) {

                // remove clicked object from view
                this.setAttribute('visible', false);
                //slower...
                //document.getElementById('cube').setAttribute('visible', false);


            });
        }
      });

      function doSomethingElse() {
        //window.location.href="https://rocketvirtual.com";
        document.getElementById('sphere').setAttribute('color', 'purple');
      }

      //   audio problem (and it is...) https://stackoverflow.com/questions/47921013/play-sound-on-click-in-a-frame?answertab=active#tab-top
      AFRAME.registerComponent('audiohandler', {
        init:function() {
            let playing = false;
            let audio = document.querySelector("#playAudio");
            this.el.addEventListener('click', () => {

                if(!playing) {
                    audio.play();
                } else {
                    audio.pause();
                    audio.currentTime = 0;
                }
                playing = !playing;
            });
        }
      })

  </script>

  </head>
  <body>

    <button id="playButton" type="button">Play Music</button>
    <!-- I like the sound of this fun, joyful Carnival Banna tune for game: this "Royalty Purchase" for 10,000 downloads -->
    <audio id="playAudio" autoplay loop>
<!--        <source src="https://rocketvirtual.com/webvr/mp3/Carnival_Banana.mp3" type="audio/mpeg">    -->
    </audio>

<!-- used for creating Navmesh... see javascript component above <a-scene inspector-plugin-recast>  https://github.com/donmccurdy/aframe-inspector-plugin-recast-->

    <a-scene background="color: #FAFAFA">

      <a-assets>

            <img crossorigin="anonymous" id="VRnode_CPortal" src="https://rocketvirtual.com/images/Portal_Desert.png">
            <img crossorigin="anonymous" id="grid" src="https://rocketvirtual.com/images/opaic_grid.png">

      </a-assets>

      <a-entity environment="preset:default;skyType:gradient;skyColor:#33A4F4;ground:canyon;groundTexture:walkernoise;grid:1x1;gridColor:#F4DAA3;lightPosition:0 1 -0.2;"></a-entity>

      <a-entity id="NodeName" position="-2 0.058 -1.75475" text-geometry="value: Node - Gray Grid.; opacity: .5; size: .175; font: https://rawgit.com/mrdoob/three.js/dev/examples/fonts/optimer_bold.typeface.json"></a-entity>

      <!-- nav-mesh  -->
      <a-entity id="navmesh-step" gltf-model="../gltf/navmesh_stepsup.gltf" visible="false" nav-mesh=""></a-entity>

      <!-- Basic movement, selection and teleport  -->
      <a-entity id="rig" movement-controls="constrainToNavMesh: true;" position="0 0 5">
            <a-entity id="cam" camera position="0 1.6 0" look-controls="pointerLockEnabled: true">

<!--                <a-entity cursor="fuse: false;" position="0 0 -1" geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
            material="color: lawngreen; shader: flat"></a-entity>  -->
              
            </a-entity>
                
            <a-entity id="leftController" hand-controls="left" tracked-controls vive-controls="hand: left" oculus-touch-controls="hand: left"
                 windows-motion-controls="hand: left" teleport-controls="cameraRig: #rig; button: trigger; curveShootingSpeed: 10; collisionEntities: #navmesh-step;" visible="true" scale="0.5 0.5 0.5"  ></a-entity>

            <a-entity id="rightController" hand-controls="right" tracked-controls vive-controls="hand: right" oculus-touch-controls="hand: right"
                 windows-motion-controls="hand: right" laser-controls raycaster="showLine: true; far: 20; interval: 0; objects: .clickable, a-link;" line="color: lawngreen; opacity: 0.5" visible="true" scale="0.5 0.5 0.5" ></a-entity>

      </a-entity>

      <a-box id="box" position="-5.26077 0.65874 -4" rotation="-90 0 0" scale="1 1 0.025" width="4" height="4" color="#FFFFFF" shadow="false" material="src: #grid; opacity: 1;" ></a-box>
      <a-box id="box-2" position="-0.10215 3.21591 1.32841" rotation="-90 0 0" scale="1 1 0.025" width="4" height="4" color="#FFFFFF" shadow="false" material="src: #grid; opacity: 1;" ></a-box>
      <a-box id="box-3" position="-5.26 0.659 -4.00" rotation="-90 0 0" scale="1 1 0.025" width="4" height="4" color="#FFFFFF" shadow="false" material="src: #grid; opacity: 1;" ></a-box>
      <a-box id="box-4" position="4.554 4.854 -6.674" rotation="-90 0 0" scale="1 1 0.025" width="4" height="4" color="#FFFFFF" shadow="false" material="src: #grid; opacity: 1;" ></a-box>
      <a-box id="box-5" position="-5.26 8.203 -4.347" rotation="-90 0 0" scale="1 1 0.025" width="4" height="4" color="#FFFFFF" shadow="false" material="src: #grid; opacity: 1;" ></a-box>
      <a-box id="box-6" position="2.477 10.74 0.793" rotation="-90 0 0" scale="1 1 0.025" width="4" height="4" color="#FFFFFF" shadow="false" material="src: #grid; opacity: 1;" ></a-box>

      <a-link href="https://rocketvirtual.com/html/VRnodeLabelC5.html" color="white" image="#VRnode_CPortal" visible="true" title="Desert" on="click" position="-16.547 2.229 0.690" rotation="0 -92.2 0" scale="2 2 2" material="shader: portal; borderEnabled: 1; pano: #VRnode_CPortal; side: back"></a-link>

    </a-scene>

  </body>
</html>        
